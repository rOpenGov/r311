<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>r311: An R interface to the open311 standard • r311</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="r311: An R interface to the open311 standard">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=B612+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100..700;1,100..700&amp;display=swap" rel="stylesheet">
<!-- rogtemplate style sheet --><link href="../BS5/rogtemplate.min.css" rel="stylesheet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">r311</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/r311.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenGov/r311/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>r311: An R interface to the open311 standard</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rOpenGov/r311/blob/main/vignettes/r311.Rmd" class="external-link"><code>vignettes/r311.Rmd</code></a></small>
      <div class="d-none name"><code>r311.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>open311 is an international open-access standard for civic issue
management and public service communication. The standard allows
administrations to better manage citizen requests, citizens to more
easily participate in administrative work, and researchers and data
scientists to access data regarding public service communication. As an
open standard, open311 is not a centralized API, but a framework
implemented by various cities (e.g. San Francisco, CA, Chicago, IL,
Cologne, DE, Turku, FI, Zurich, CH) and services (e.g. SeeClickFix,
FixMyStreet).</p>
<p>It is way past the golden age of open311 APIs and much of development
in civic issue tracking has shifted to less open-access and less
standardized alternatives. Many former prime examples have abandoned or
severely limited their open311 endpoints. Nonetheless, open311 still
constitutes a valuable source for open government data. Many cities and
services still maintain an open311 service.</p>
<p><code>r311</code> allows the seamless management and selection of
endpoints and retrieval of service and request data. It supports (but
does not depend on) many popular R frameworks such as the tidyverse,
<code>sf</code> and <code>xml2</code> for response formatting.
<code>r311</code> is designed to be slim, both in content and
dependencies. It imports only two import-less packages used for HTTP
response handling. The functionality is limited to two main
features:</p>
<ul>
<li>Endpoint management</li>
<li>Sending requests</li>
</ul>
<p>This vignette will briefly cover these two features.</p>
</div>
<div class="section level2">
<h2 id="endpoints">Endpoints<a class="anchor" aria-label="anchor" href="#endpoints"></a>
</h2>
<p>Since open311 is an open and decentralized standard, there is not one
but many endpoints that one can access. An endpoint is commonly
implemented by a city administration, but can also be managed by a
service provider such as FixMyStreet. Each endpoint can define multiple
jurisdiction IDs, although, in practice, most endpoints only define a
single jurisdiction.</p>
<p>It can thus be difficult to manage the multitude of endpoints and
jurisdictions. Efforts have been made to list open311 servers, but most
of them are incomplete or outdated. <code>r311</code> offers an updated
and modifiable endpoint list that defines a number of open311
implementations that are defined for use in the package. The list can be
read using <code>o311_endpoints</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_endpoints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 69 × 12</span></span>
<span><span class="co">#&gt;    name            root  docs  jurisdiction key   pagination limit json  dialect deprecated deprecated_reason deprecated_url</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;lgl&gt; &lt;lgl&gt;      &lt;int&gt; &lt;lgl&gt; &lt;chr&gt;   &lt;lgl&gt;      &lt;chr&gt;             &lt;chr&gt;         </span></span>
<span><span class="co">#&gt;  1 Annaberg-Buchh… http… http… annberg-buc… FALSE TRUE          50 TRUE  Mark-a… TRUE       switched          https://buerg…</span></span>
<span><span class="co">#&gt;  2 Bloomington, IN http… &lt;NA&gt;  bloomington… FALSE TRUE        1000 TRUE  uReport FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  3 Bonn, DE        http… http… bonn.de      FALSE TRUE         100 TRUE  Mark-a… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  4 Boston, MA      http… http… &lt;NA&gt;         FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  5 Brookline, MA   http… http… brooklinema… FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  6 Austin, TX      http… http… &lt;NA&gt;         FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  7 Chicago, IL     311a… 311a… cityofchica… FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  8 Newport News, … http… http… cityofnewpo… FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  9 San Diego, CA   http… http… sandiego.gov FALSE TRUE          50 TRUE  Connec… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; 10 Köln / Cologne… http… &lt;NA&gt;  stadt-koeln… FALSE TRUE          50 TRUE  Mark-a… FALSE      &lt;NA&gt;              &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; # ℹ 59 more rows</span></span></code></pre></div>
<p>The list does neither claim comprehensiveness nor up-to-dateness. It
arguably provides some of the most important and easily accessible
endpoints as of 2025. However, <code>r311</code> also offers the ability
to add new endpoints to <code>o311_endpoints</code> using
<code>o311_add_endpoint</code>. You need to provide a name (for lookup)
and a root URL (the URL used to send requests). The following code adds
the open311 test server of Mecklenburg-Vorpommern, Germany.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_add_endpoint</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"MV Test"</span>,</span>
<span>  root <span class="op">=</span> <span class="st">"https://klarschiff-mv.sis-schwerin.de/backoffice/citysdk/"</span>,</span>
<span>  jurisdiction <span class="op">=</span> <span class="st">"rostock.de"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Retrieving the endpoints list again confirms that you successfully
added a new row to the endpoints dataframe.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="../reference/o311_endpoints.html">o311_endpoints</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 70</span></span></code></pre></div>
<p>You can now select the Rostock test API to the session using
<code>o311_api</code>. This function matches an API using endpoint name
and jurisdiction ID and attaches it to the active session. Query
functions automatically detect the attached API.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"MV Test"</span><span class="op">)</span></span></code></pre></div>
<p>After attaching an API, <code>o311_ok</code> confirms that the
selected endpoint is able to handle request queries.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_ok.html">o311_ok</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>As the result is <code>TRUE</code>, you can safely start receiving
real request data.</p>
</div>
<div class="section level2">
<h2 id="making-requests">Making requests<a class="anchor" aria-label="anchor" href="#making-requests"></a>
</h2>
<p>After selecting an API and attaching it to the session, all functions
can access it. You can now make requests.</p>
<div class="section level3">
<h3 id="services">Services<a class="anchor" aria-label="anchor" href="#services"></a>
</h3>
<p>To get an overview of the available services in a jurisdiction, you
can use <code>o311_services</code>, which returns a list of Rostock’s
administrative services.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_services.html">o311_services</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 183 × 8</span></span>
<span><span class="co">#&gt;    service_code service_name                       description metadata type     keywords group            group_id</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;                              &lt;lgl&gt;       &lt;lgl&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;               &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 127          Ampel behindertengerecht gestalten NA          FALSE    realtime idea     Barrierefreiheit       11</span></span>
<span><span class="co">#&gt;  2 128          Ampelschaltung ändern              NA          FALSE    realtime idea     Barrierefreiheit       11</span></span>
<span><span class="co">#&gt;  3 129          Bordstein absenken                 NA          FALSE    realtime idea     Barrierefreiheit       11</span></span>
<span><span class="co">#&gt;  4 130          Zugang rollstuhlgerecht gestalten  NA          FALSE    realtime idea     Barrierefreiheit       11</span></span>
<span><span class="co">#&gt;  5 131          Ampelschaltung ändern              NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt;  6 132          Beleuchtung verändern              NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt;  7 133          Beschilderung/Markierung ändern    NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt;  8 134          Beschilderung/Markierung einführen NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt;  9 135          Bordstein absenken                 NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt; 10 136          Fahrradständer aufstellen          NA          FALSE    realtime idea     Fahrradverkehr         12</span></span>
<span><span class="co">#&gt; # ℹ 173 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="requests">Requests<a class="anchor" aria-label="anchor" href="#requests"></a>
</h3>
<p>To get data about civic issues in the city area, run
<code>o311_requests</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 52 features and 15 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 11.17392 ymin: 53.38346 xmax: 13.31174 ymax: 54.20873</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 52 × 16</span></span>
<span><span class="co">#&gt;    service_request_id status_notes            status service_code service_name description agency_responsible service_notice</span></span>
<span><span class="co">#&gt;                 &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;              &lt;lgl&gt;         </span></span>
<span><span class="co">#&gt;  1                263 &lt;NA&gt;                    recei…           30 Sperrmüll    redaktione… Abfallwirtschaft … NA            </span></span>
<span><span class="co">#&gt;  2                217 &lt;NA&gt;                    recei…          103 Baum schadh… redaktione… Forstamt           NA            </span></span>
<span><span class="co">#&gt;  3                272 Reparatur beauftragt    in_pr…            4 bauliche Ge… Hier ist ü… LK-LUP-Verkehr     NA            </span></span>
<span><span class="co">#&gt;  4                150 Vielen Dank für Ihren … in_pr…            5 Beleuchtung… Straßenlat… Bauamt             NA            </span></span>
<span><span class="co">#&gt;  5                173 Vorgang wurde zur Bear… in_pr…            3 Ampel schad… Ampel scha… Regional-Administ… NA            </span></span>
<span><span class="co">#&gt;  6                154 Das Anliegen wird im B… in_pr…           13 Hundekot     Die Haltes… Beschwerdemanagem… NA            </span></span>
<span><span class="co">#&gt;  7                210 &lt;NA&gt;                    recei…          117 Wegereinigu… redaktione… Forstamt           NA            </span></span>
<span><span class="co">#&gt;  8                201 &lt;NA&gt;                    recei…          162 Schutzhütte… redaktione… Forstamt           NA            </span></span>
<span><span class="co">#&gt;  9                166 Verstanden.             in_pr…            3 Ampel schad… redaktione… Bauamt (Amt Rosto… NA            </span></span>
<span><span class="co">#&gt; 10                245 Vielen Dank für den Hi… in_pr…            8 Beschilderu… Zusatzzeic… Parchim - FB 3 Re… NA            </span></span>
<span><span class="co">#&gt; # ℹ 42 more rows</span></span>
<span><span class="co">#&gt; # ℹ 8 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;, expected_datetime &lt;lgl&gt;, address &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   adress_id &lt;lgl&gt;, media_url &lt;chr&gt;, zipcode &lt;lgl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
<p>Using the output of <code>o311_services</code>, you can further
narrow down the output of requests. Open311 defines a set of standard
parameters which are implemented by all endpoints. Using the
<code>service_code</code> parameter with one of the previously returned
service codes, only complaints about broken traffic lights are
returned.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>service_code <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 15 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 11.84164 ymin: 53.41644 xmax: 12.31198 ymax: 54.20656</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 16</span></span>
<span><span class="co">#&gt;   service_request_id status_notes             status service_code service_name description agency_responsible service_notice</span></span>
<span><span class="co">#&gt;                &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;              &lt;lgl&gt;         </span></span>
<span><span class="co">#&gt; 1                166 Verstanden.              in_pr…            3 Ampel schad… "redaktion… Bauamt (Amt Rosto… NA            </span></span>
<span><span class="co">#&gt; 2                158 &lt;NA&gt;                     revie…            3 Ampel schad… "Die Ampel… Straßenmeisterei … NA            </span></span>
<span><span class="co">#&gt; 3                251 &lt;NA&gt;                     recei…            3 Ampel schad… "redaktion… LK-LUP-Verkehr     NA            </span></span>
<span><span class="co">#&gt; 4                173 Vorgang wurde zur Bearb… in_pr…            3 Ampel schad… "Ampel sch… Regional-Administ… NA            </span></span>
<span><span class="co">#&gt; 5                250 Vielen Dank für die Mel… in_pr…            3 Ampel schad… "Ampel aus… LK-LUP-Verkehr     NA            </span></span>
<span><span class="co">#&gt; 6                273 &lt;NA&gt;                     recei…            3 Ampel schad… "Die Daten… Standardzuständig… NA            </span></span>
<span><span class="co">#&gt; # ℹ 8 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;, expected_datetime &lt;lgl&gt;, address &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   adress_id &lt;lgl&gt;, media_url &lt;lgl&gt;, zipcode &lt;lgl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
<p>Similarly, using a <code>service_request_id</code> from the output,
you can retrieve a single service request from the API.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_request</a></span><span class="op">(</span><span class="st">"250"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 15 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 11.86831 ymin: 53.43376 xmax: 11.86831 ymax: 53.43376</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 16</span></span>
<span><span class="co">#&gt;   service_request_id status_notes             status service_code service_name description agency_responsible service_notice</span></span>
<span><span class="co">#&gt;                &lt;int&gt; &lt;chr&gt;                    &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;              &lt;lgl&gt;         </span></span>
<span><span class="co">#&gt; 1                250 Vielen Dank für die Mel… in_pr…            3 Ampel schad… Ampel ausg… LK-LUP-Verkehr     NA            </span></span>
<span><span class="co">#&gt; # ℹ 8 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;, expected_datetime &lt;lgl&gt;, address &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   adress_id &lt;lgl&gt;, media_url &lt;lgl&gt;, zipcode &lt;lgl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bulk-queries">Bulk queries<a class="anchor" aria-label="anchor" href="#bulk-queries"></a>
</h3>
<p>Many endpoints define a page limit meaning that responses are divided
into pages. A query without parameters returns the first page.
Pagination can be controlled with the <code>page</code> argument. To
control pagination, the <code>o311_request_all</code> function can come
in handy. It automatically iterates through pages and heuristically
decides when to stop. The following example retrieves data from the
first two pages, resulting in a tibble with 200 service requests.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"Cologne"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/o311_requests.html">o311_request_all</a></span><span class="op">(</span>max_pages <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 200 features and 11 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 6.820434 ymin: 50.85319 xmax: 7.104497 ymax: 51.05203</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 200 × 12</span></span>
<span><span class="co">#&gt;    service_request_id title     description address_string service_name requested_datetime updated_datetime status media_url</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;              &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 1345-2025          #1345-20… "Die Abspe… 50674 Köln - … Straßenbaus… 2025-01-15T15:39:… 2025-02-15T09:2… closed "https:/…</span></span>
<span><span class="co">#&gt;  2 1348-2025          #1348-20… "Sehr geeh… 51103 Köln - … Defekte Obe… 2025-01-15T15:55:… 2025-01-16T14:0… closed "https:/…</span></span>
<span><span class="co">#&gt;  3 1346-2025          #1346-20… "Hier entl… 50935 Köln - … Defekte Obe… 2025-01-15T15:56:… 2025-01-16T14:0… closed ""       </span></span>
<span><span class="co">#&gt;  4 1347-2025          #1347-20… "Dürenerst… 50935 Köln - … Defekte Obe… 2025-01-15T15:58:… 2025-01-16T14:0… closed ""       </span></span>
<span><span class="co">#&gt;  5 1349-2025          #1349-20… "Vom Obere… 50969 Köln - … Kfz-Ampel d… 2025-01-15T16:24:… 2025-02-15T06:2… closed ""       </span></span>
<span><span class="co">#&gt;  6 1351-2025          #1351-20… "Stolperfa… 50999 Köln - … Defekte Obe… 2025-01-15T16:27:… 2025-01-16T14:0… closed "https:/…</span></span>
<span><span class="co">#&gt;  7 1350-2025          #1350-20… "Laterne h… 50823 Köln - … Leuchtmitte… 2025-01-15T16:28:… 2025-02-15T12:2… closed "https:/…</span></span>
<span><span class="co">#&gt;  8 1352-2025          #1352-20… "Wilder Mü… 51109 Köln - … Wilder Müll  2025-01-15T16:37:… 2025-02-15T12:2… closed "https:/…</span></span>
<span><span class="co">#&gt;  9 1353-2025          #1353-20… "Der Fußwe… 50677 Köln - … Defekte Obe… 2025-01-15T17:17:… 2025-01-16T14:1… closed "https:/…</span></span>
<span><span class="co">#&gt; 10 1354-2025          #1354-20… "Seit Mona… 50823 Köln - … Schrottfahr… 2025-01-15T17:40:… 2025-01-16T11:4… open   ""       </span></span>
<span><span class="co">#&gt; # ℹ 190 more rows</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: status_note &lt;chr&gt;, service_code &lt;chr&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="non-standard-parameters">Non-standard parameters<a class="anchor" aria-label="anchor" href="#non-standard-parameters"></a>
</h3>
<p><code>r311</code> implicitly supports API extensions introducing
custom paths and parameters. One such API is Klarschiff Rostock which is
based on CitySDK. Klarschiff CitySDK defines a number of non-default
paths and parameters which extend the filtering abilities of open311
requests. Available parameters can usually be found in the respective
documentation (e.g. on GitHub for <a href="https://github.com/bfpi/klarschiff-citysdk" class="external-link">Klarschiff
CitySDK</a>). The following query returns the last 50 requests tagged
with the “idea” keyword.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_api.html">o311_api</a></span><span class="op">(</span><span class="st">"Rostock, DE"</span><span class="op">)</span></span>
<span><span class="va">tickets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>keyword <span class="op">=</span> <span class="st">"idea"</span>, max_requests <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">tickets</span></span>
<span><span class="co">#&gt; Simple feature collection with 50 features and 15 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 12.0452 ymin: 54.06011 xmax: 12.17308 ymax: 54.17656</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 50 × 16</span></span>
<span><span class="co">#&gt;    service_request_id status_notes            status service_code service_name description agency_responsible service_notice</span></span>
<span><span class="co">#&gt;                 &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;              &lt;lgl&gt;         </span></span>
<span><span class="co">#&gt;  1              48005 &lt;NA&gt;                    recei…           93 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  2              42258 &lt;NA&gt;                    revie…           99 Beschilderu… "Oft kommt… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  3              50762 &lt;NA&gt;                    recei…          113 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  4              40539 &lt;NA&gt;                    revie…          112 Beschilderu… "Sehr geeh… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  5              45486 &lt;NA&gt;                    recei…          113 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  6              42022 &lt;NA&gt;                    recei…          112 Beschilderu… "Nach dem … Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  7              46210 &lt;NA&gt;                    recei…           93 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  8              50520 &lt;NA&gt;                    recei…          113 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt;  9              40653 Vielen Dank für Ihren … in_pr…           93 Beschilderu… "Wenn ich … Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt; 10              42112 &lt;NA&gt;                    recei…           99 Beschilderu… "redaktion… Tiefbauamt (Unter… NA            </span></span>
<span><span class="co">#&gt; # ℹ 40 more rows</span></span>
<span><span class="co">#&gt; # ℹ 8 more variables: requested_datetime &lt;chr&gt;, updated_datetime &lt;chr&gt;, expected_datetime &lt;lgl&gt;, address &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   adress_id &lt;lgl&gt;, media_url &lt;chr&gt;, zipcode &lt;lgl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
<p>Some custom parameters can also alter the shape of the output. In the
following example, we query just the count of total requests using the
<code>just_count</code> parameter. The result is a 1×1 tibble containing
a count value.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_requests.html">o311_requests</a></span><span class="op">(</span>just_count <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 1</span></span>
<span><span class="co">#&gt;   value</span></span>
<span><span class="co">#&gt;   &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1  3352</span></span></code></pre></div>
<p>The CitySDK extensions also offers additional URL paths which can be
queried using the generic <code>o311_query</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/o311_query.html">o311_query</a></span><span class="op">(</span><span class="st">"areas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">poly</span><span class="op">$</span><span class="va">grenze</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tickets</span><span class="op">$</span><span class="va">geometry</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure%2Fmap-1.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="cleanup">Cleanup<a class="anchor" aria-label="anchor" href="#cleanup"></a>
</h2>
<p>Endpoint data is stored persistently between sessions so that you can
create your own database of open311 endpoints. This database is stored
in the system’s user directory as returned by
<code>tools::R_user_dir("r311")</code>. To reset the database, run</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/o311_endpoints.html">o311_reset_endpoints</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will default back to the endpoints defined by <code>r311</code>
and remove all endpoints manually added by
<code>o311_add_endpoints</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>



    <!-- Add ropengov logo -->
  <script src="../BS5/logo.js"></script>
</body>
</html>
